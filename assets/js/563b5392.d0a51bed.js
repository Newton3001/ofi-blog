"use strict";(self.webpackChunkofi_blog_versioned=self.webpackChunkofi_blog_versioned||[]).push([[74315],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>u});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var m=r.createContext({}),d=function(e){var t=r.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=d(e.components);return r.createElement(m.Provider,{value:t},e.children)},l="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,m=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),l=d(n),k=a,u=l["".concat(m,".").concat(k)]||l[k]||c[k]||i;return n?r.createElement(u,o(o({ref:t},s),{},{components:n})):r.createElement(u,o({ref:t},s))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=k;var p={};for(var m in t)hasOwnProperty.call(t,m)&&(p[m]=t[m]);p.originalType=e,p[l]="string"==typeof e?e:a,o[1]=p;for(var d=2;d<i;d++)o[d]=n[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}k.displayName="MDXCreateElement"},23161:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>p,toc:()=>d});var r=n(87462),a=(n(67294),n(3905));const i={sidebar_custom_props:{id:"d5c4dacd-0817-451b-9a4e-e8ab9bf283cf"}},o="3. Netzwerk",p={unversionedId:"EF-IOT-Workshop/micropython/netzwerk/index",id:"EF-IOT-Workshop/micropython/netzwerk/index",title:"3. Netzwerk",description:"Sie brauchen einen Node-RED Server, der im Internet erreichbar ist.",source:"@site/docs/EF-IOT-Workshop/05-micropython/03-netzwerk/index.md",sourceDirName:"EF-IOT-Workshop/05-micropython/03-netzwerk",slug:"/EF-IOT-Workshop/micropython/netzwerk/",permalink:"/EF-IOT-Workshop/micropython/netzwerk/",draft:!1,editUrl:"https://github.com/lebalz/ofi-blog/edit/main/docs/EF-IOT-Workshop/05-micropython/03-netzwerk/index.md",tags:[],version:"current",lastUpdatedAt:1688123641,formattedLastUpdatedAt:"30. Juni 2023",frontMatter:{sidebar_custom_props:{id:"d5c4dacd-0817-451b-9a4e-e8ab9bf283cf"}},sidebar:"sidebar",previous:{title:"2. Sensoren",permalink:"/EF-IOT-Workshop/micropython/sensoren/"},next:{title:"4. Sensorbox",permalink:"/EF-IOT-Workshop/micropython/sensorbox/"}},m={},d=[{value:"Proxy-Server",id:"proxy-server",level:2},{value:"ESP8266",id:"esp8266",level:2}],s=(l="Comment",function(e){return console.warn("Component "+l+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",e)});var l;const c={toc:d},k="wrapper";function u(e){let{components:t,...i}=e;return(0,a.kt)(k,(0,r.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("h1",{parentName:"div",id:"3-netzwerk"},"3. Netzwerk"),(0,a.kt)(s,{parentName:"div",type:"heading",nr:0,mdxType:"Comment"})),(0,a.kt)("admonition",{title:"Voraussetzung",type:"info"},(0,a.kt)("div",{parentName:"admonition",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Sie brauchen einen Node-RED Server, der im Internet erreichbar ist."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:0,mdxType:"Comment"})),(0,a.kt)("div",{parentName:"admonition",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Falls Sie diesen noch nicht aufgesetzt haben, k\xf6nnen Sie zum Node-Red Teil wechseln und dort einen Server aufsetzen."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:1,mdxType:"Comment"}))),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Hier merken wir die Limitationen vom eingesetzten ESP8266: Er ist im allgemeinen nicht schnell genug, um die Zertifikate von sicheren HTTPS Webseiten zu verifizieren. Aus diesem Grund verwenden wir nur HTTP-Verbindungen."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:2,mdxType:"Comment"})),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Doch Node-RED ist ausschliesslich \xfcber HTTPS erreichbar. Wie funktioniert dies nun?"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:3,mdxType:"Comment"})),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("h2",{parentName:"div",id:"proxy-server"},"Proxy-Server"),(0,a.kt)(s,{parentName:"div",type:"heading",nr:1,mdxType:"Comment"})),(0,a.kt)("blockquote",null,(0,a.kt)("div",{parentName:"blockquote",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Der Proxy Server ist ein Vermittler oder Stellvertreter und nimmt Anfragen entgegen, die er unter seiner eigenen Identit\xe4t weiterleitet.\nKommt eine Verbindung zwischen einem Client und einem Server zustande, bleiben die Adressen von Client und Server den Kommunikationspartnern jeweils verborgen. Im Gegensatz zur Network Address Translation (NAT) werden Adressen nicht nur einfach ausgetauscht, sondern der Proxy Server f\xfchrt die Kommunikation selbst. ",(0,a.kt)("sup",{parentName:"p",id:"fnref-1"},(0,a.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:4,mdxType:"Comment"}))),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Wir verwenden also einen Proxy-Server, welcher \xfcber HTTP erreichbar ist und die Anfrage dann per HTTPS an den Node-RED Server weiterleitet. Die Antwort wird dann wiederum per HTTP an den ESP8266 zur\xfcckgeschickt."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:5,mdxType:"Comment"})),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Der Proxy-Server ist auf dem Informatik-Server der Schule gehostet und ist unter der Adresse ",(0,a.kt)("a",{parentName:"p",href:"http://proxy.gbsl.website"},"http://proxy.gbsl.website")," erreichbar. Damit nun der Proxy-Server weiss, wohin die eigentliche Anfrage gehen soll, wird die URL wie folgt ver\xe4ndert:"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:6,mdxType:"Comment"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Ziel-Adresse: https://node-red-XY7Z.onrender.com/api/joke\n                      \\________________________/\\_______/\n                               |                    |\n                              URI                  path\n\nProxy-URL:     http://<URI>.proxy.gbsl.website/<path>\n                      \\___/                    \\____/\n                        |                         |\n                    Subsubdomain                 path\n\nProxy-Adresse: http://node-red-XY7Z.onrender.com.proxy.gbsl.website/api/joke                              \n")),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("h2",{parentName:"div",id:"esp8266"},"ESP8266"),(0,a.kt)(s,{parentName:"div",type:"heading",nr:2,mdxType:"Comment"})),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Im Terminal des ESP8266 k\xf6nnen wir nun Daten direkt an den Node-RED Server senden. Anstatt mit Postman schicken wir nun also die Daten direkt vom ESP8266 an den Server."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:7,mdxType:"Comment"})),(0,a.kt)("div",{className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Dazu m\xfcssen wir"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:8,mdxType:"Comment"})),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("div",{parentName:"li",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"eine Verbindung zu einem Netzwerk herstellen (",(0,a.kt)("inlineCode",{parentName:"p"},"network"),")"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:9,mdxType:"Comment"}))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("div",{parentName:"li",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Daten abschicken und auf Antwort warten (",(0,a.kt)("inlineCode",{parentName:"p"},"urequests"),")"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:10,mdxType:"Comment"}))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("div",{parentName:"li",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"offene Verbindungen schliessen"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:11,mdxType:"Comment"})))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import network\n# WLAN als Empfangsstation initialisieren\nwlan = network.WLAN(network.STA_IF)\n# WLAN aktivieren\nwlan.active(True)\n# verbinden mit dem Netzwerk\nwlan.connect('SSID', 'PASSWORD')\n# ist das Netzwerk verbunden?\nwlan.isconnected()\n\n\n# HTTP-Request erstellen\nimport urequests\n# Datenpaket erstellen\ndata = {'value': 42}\n# Datenpaket abschicken\nres = urequests.post('http://node-red-xyzq.onrender.com.proxy.gbsl.website/api/sensor', json=data)\n# Antwort ausgeben\nres.content\n\n# Verbindung schliessen\nres.close()\n")),(0,a.kt)("admonition",{title:"Mit dem Netzwerk verbinden",type:"aufgabe"},(0,a.kt)("div",{parentName:"admonition",className:"commentable"},(0,a.kt)("dl",{parentName:"div"},(0,a.kt)("dt",{parentName:"dl"},"Material\n"),(0,a.kt)("dd",{parentName:"dl"},(0,a.kt)("a",{target:"_blank",href:n(2770).Z},"\ud83d\udc49 Netzwerk-Projekt"))),(0,a.kt)(s,{parentName:"div",type:"deflist",nr:0,mdxType:"Comment"})),(0,a.kt)("div",{parentName:"admonition",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Laden Sie das Beispiel-Projekt herunter und untersuchen Sie dieses genauer."),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:12,mdxType:"Comment"})),(0,a.kt)("div",{parentName:"admonition",className:"commentable"},(0,a.kt)("p",{parentName:"div"},"Passen Sie dieses so an, dass die Daten an Ihren eigenen Node-RED Server geschickt werden. ()"),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:13,mdxType:"Comment"}))),(0,a.kt)("div",{className:"footnotes"},(0,a.kt)("hr",{parentName:"div"}),(0,a.kt)("ol",{parentName:"div"},(0,a.kt)("li",{parentName:"ol",id:"fn-1"},(0,a.kt)("div",{parentName:"li",className:"commentable"},(0,a.kt)("p",{parentName:"div"},(0,a.kt)("a",{parentName:"p",href:"https://www.ip-insider.de/was-ist-ein-proxy-server-a-665349/"},"Ip-Insider")),(0,a.kt)(s,{parentName:"div",type:"paragraph",nr:14,mdxType:"Comment"})),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"#fnref-1",className:"footnote-backref"},"\u21a9"))))))}u.isMDXComponent=!0},2770:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/files/network-assets-67064f665cd6093e85e77175b1e7cf5d.zip"}}]);
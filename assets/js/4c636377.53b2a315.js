"use strict";(self.webpackChunkofi_blog_versioned=self.webpackChunkofi_blog_versioned||[]).push([[94972],{3905:(e,n,a)=>{a.d(n,{Zo:()=>l,kt:()=>k});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function m(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function d(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=t.createContext({}),p=function(e){var n=t.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):m(m({},n),e)),a},l=function(e){var n=p(e.components);return t.createElement(o.Provider,{value:n},e.children)},s="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},g=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=d(e,["components","mdxType","originalType","parentName"]),s=p(a),g=r,k=s["".concat(o,".").concat(g)]||s[g]||c[g]||i;return a?t.createElement(k,m(m({ref:n},l),{},{components:a})):t.createElement(k,m({ref:n},l))}));function k(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=a.length,m=new Array(i);m[0]=g;var d={};for(var o in n)hasOwnProperty.call(n,o)&&(d[o]=n[o]);d.originalType=e,d[s]="string"==typeof e?e:r,m[1]=d;for(var p=2;p<i;p++)m[p]=a[p];return t.createElement.apply(null,m)}return t.createElement.apply(null,a)}g.displayName="MDXCreateElement"},28919:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>m,default:()=>b,frontMatter:()=>i,metadata:()=>d,toc:()=>p});var t=a(87462),r=(a(67294),a(3905));const i={sidebar_custom_props:{id:"e50cdb95-82e3-4287-9726-ab9e63aeb557"}},m="Aggregierte Abfragen",d={unversionedId:"Datenbanken/sql/aggregation",id:"version-24ef/Datenbanken/sql/aggregation",title:"Aggregierte Abfragen",description:"Oft sollen ergebnisse in einer zusammengefassten Form ausgegeben werden. So interessiert einem bspw. oft, wie viele Datens\xe4tze in einer Tabelle vorhanden sind, oder wie hoch der Durchschnittswert einer Spalte ist. Hierf\xfcr gibt es die sogenannten Aggregatfunktionen.",source:"@site/versioned_docs/version-24ef/03-Datenbanken/01-sql/02-aggregation.md",sourceDirName:"03-Datenbanken/01-sql",slug:"/Datenbanken/sql/aggregation",permalink:"/24ef/Datenbanken/sql/aggregation",draft:!1,editUrl:"https://github.com/lebalz/ofi-blog/tree/main/docs",tags:[],version:"24ef",sidebarPosition:2,frontMatter:{sidebar_custom_props:{id:"e50cdb95-82e3-4287-9726-ab9e63aeb557"}},sidebar:"version-24ef/sidebar",previous:{title:"Einstieg SQL",permalink:"/24ef/Datenbanken/sql/einstieg"},next:{title:"Mehrtabellenabfragen (Joins)",permalink:"/24ef/Datenbanken/sql/joins"}},o={},p=[{value:"Group By",id:"group-by",level:2}],l=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",n)},s=l("Comment"),c=l("Answer"),g=l("Solution"),k={toc:p},N="wrapper";function b(e){let{components:n,...a}=e;return(0,r.kt)(N,(0,t.Z)({},k,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"commentable"},(0,r.kt)("h1",{parentName:"div",id:"aggregierte-abfragen"},"Aggregierte Abfragen"),(0,r.kt)(s,{parentName:"div",type:"heading",nr:0,mdxType:"Comment"})),(0,r.kt)("div",{className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Oft sollen ergebnisse in einer zusammengefassten Form ausgegeben werden. So interessiert einem bspw. oft, wie viele Datens\xe4tze in einer Tabelle vorhanden sind, oder wie hoch der Durchschnittswert einer Spalte ist. Hierf\xfcr gibt es die sogenannten ",(0,r.kt)("strong",{parentName:"p",className:"underline"},"Aggregatfunktionen"),"."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:0,mdxType:"Comment"})),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"count"},(0,r.kt)("inlineCode",{parentName:"h3"},"COUNT(*)")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:1,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Z\xe4hlt die Anzahl der Datens\xe4tze in einer Tabelle."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:1,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT COUNT(*) FROM legodudes;\n/* count \n  -------\n      7   */\n"))),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"sum"},(0,r.kt)("inlineCode",{parentName:"h3"},"SUM()")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:2,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Addiert die Werte einer Spalte."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:2,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT SUM(lieblingszahl) FROM legodudes;\n/*  sum \n   -----\n    651 */\n"))),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"avg"},(0,r.kt)("inlineCode",{parentName:"h3"},"AVG()")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:3,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Berechnet den Mittelwert der Werte einer Spalte."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:3,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT AVG(lieblingszahl) FROM legodudes;\n/*  avg \n   ------\n    93.0  */\n"))),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"max"},(0,r.kt)("inlineCode",{parentName:"h3"},"MAX()")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:4,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Gibt den maximalen Wert einer Spalte zur\xfcck."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:4,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT MAX(lieblingszahl) FROM legodudes;\n/*  max \n   ------\n    420  */\n"))),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"min"},(0,r.kt)("inlineCode",{parentName:"h3"},"MIN()")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:5,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Gibt den minimalen Wert einer Spalte zur\xfcck."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:5,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT MIN(lieblingszahl) FROM legodudes;\n/*  min \n   -----\n     1  */\n"))),(0,r.kt)("div",{className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Damit lassen sich nun auch bspw. alle Legodudes ausgeben, die die h\xf6chste Lieblingszahl haben, wobei die ",(0,r.kt)("inlineCode",{parentName:"p"},"MAX()"),"-Funktion in einer verschachtelten Unterabfrage verwendet wird."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:6,mdxType:"Comment"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM legodudes \nWHERE lieblingszahl = (SELECT MAX(lieblingszahl) FROM legodudes);\n")),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"string_aggcolumn-delimiter-order-by-column-ascdesc"},(0,r.kt)("inlineCode",{parentName:"h3"},"STRING_AGG(column, delimiter [ORDER BY column [ASC|DESC]])")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:6,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Mit ",(0,r.kt)("inlineCode",{parentName:"p"},"STRING_AGG")," lassen sich Texte aus mehreren Zeilen zu einem Text zusammenf\xfcgen. Der ",(0,r.kt)("inlineCode",{parentName:"p"},"delimiter")," ist das Trennzeichen, das zwischen den einzelnen Texten eingef\xfcgt wird."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:7,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT string_agg(name, ', ') FROM legodudes;\n/*                                        string_agg                                                 \n--------------------------------------------------------------------------------------------------\n Litty Feuerwehr, Crazy Lego Dude, Elon Marsk, Larry der St\xfcrmer, A$AP Geerky, Wigwam Tipi, Botot  */\n")),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"oder mit Reihenfolge"),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:8,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT string_agg(name, ', ' ORDER BY name) FROM legodudes;\n/*                                        string_agg                                                 \n--------------------------------------------------------------------------------------------------\n A$AP Geerky, Botot, Crazy Lego Dude, Elon Marsk, Larry der St\xfcrmer, Litty Feuerwehr, Wigwam Tipi  */\n"))),(0,r.kt)("admonition",{title:"1. \xc4ltester Legodude",type:"aufgabe"},(0,r.kt)(c,{type:"state",webKey:"5c502b3e-547a-4aab-929e-bedc944e8a1f",mdxType:"Answer"}),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("dl",{parentName:"div"},(0,r.kt)("dt",{parentName:"dl"},"Datenbank\n"),(0,r.kt)("dd",{parentName:"dl"},(0,r.kt)("strong",{parentName:"dd",className:"underline"},"legomania")),(0,r.kt)("dd",{parentName:"dl"},"\ud83d\udc49 ",(0,r.kt)("a",{parentName:"dd",href:"https://db-sql.ch/connections/9e5bd382-6110-4f04-adf7-2b46fcdadfd5/legomania"},"https://db-sql.ch/connections/9e5bd382-6110-4f04-adf7-2b46fcdadfd5/legomania"))),(0,r.kt)(s,{parentName:"div",type:"deflist",nr:0,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Geben Sie den j\xfcngsten Legodude aus, indem Sie eine verschachtelte Unterabfrage verwenden."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:9,mdxType:"Comment"})),(0,r.kt)(c,{type:"text",webKey:"55a6f5b1-4ce1-4c8a-82f9-3e0247272352",monospace:!0,mdxType:"Answer"}),(0,r.kt)(g,{webKey:"44077255-cf6b-4d5f-a152-de6c3cf6e37e",mdxType:"Solution"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM legodudes \nWHERE alter = (SELECT MIN(alter) FROM legodudes);\n")))),(0,r.kt)("div",{className:"commentable"},(0,r.kt)("h2",{parentName:"div",id:"group-by"},"Group By"),(0,r.kt)(s,{parentName:"div",type:"heading",nr:7,mdxType:"Comment"})),(0,r.kt)("div",{className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Oft interessiert aber nicht nur die Anzahl der Datens\xe4tze, sondern die Anzahl der Datens\xe4tze pro Kategorie. Hierf\xfcr gibt es den ",(0,r.kt)("inlineCode",{parentName:"p"},"GROUP BY"),"-Befehl."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:10,mdxType:"Comment"})),(0,r.kt)("admonition",{type:"def"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("h3",{parentName:"div",id:"group-by-1"},(0,r.kt)("inlineCode",{parentName:"h3"},"GROUP BY")),(0,r.kt)(s,{parentName:"div",type:"heading",nr:8,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Mit ",(0,r.kt)("inlineCode",{parentName:"p"},"GROUP BY")," lassen sich Datens\xe4tze nach einer oder mehrerer Spalten gruppieren. Die Aggregatfunktionen werden dann auf die einzelnen Gruppen angewendet."),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:11,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT land, COUNT(*) \nFROM legodudes \nGROUP BY land;\n/*  land      | count \n  ------------+-------\n   Irland     |     1 \n   \xd6sterreich |     1 \n   Schweden   |     1 \n   USA        |     3 \n   Schweiz    |     1  */\n")),(0,r.kt)("admonition",{parentName:"admonition",title:"Wichtig",type:"warning"},(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"F\xfcr jede Spalte, die nicht in der ",(0,r.kt)("inlineCode",{parentName:"p"},"GROUP BY"),"-Klausel steht, muss eine Aggregatfunktion verwendet werden!"),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:12,mdxType:"Comment"})))),(0,r.kt)("admonition",{title:"2. Namen nach L\xe4ndern gruppiert",type:"aufgabe"},(0,r.kt)(c,{type:"state",webKey:"fbbb07f6-cd07-4efe-90db-6138295f49ac",mdxType:"Answer"}),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("dl",{parentName:"div"},(0,r.kt)("dt",{parentName:"dl"},"Datenbank\n"),(0,r.kt)("dd",{parentName:"dl"},(0,r.kt)("strong",{parentName:"dd",className:"underline"},"legomania")),(0,r.kt)("dd",{parentName:"dl"},"\ud83d\udc49 ",(0,r.kt)("a",{parentName:"dd",href:"https://db-sql.ch/connections/9e5bd382-6110-4f04-adf7-2b46fcdadfd5/legomania"},"https://db-sql.ch/connections/9e5bd382-6110-4f04-adf7-2b46fcdadfd5/legomania"))),(0,r.kt)(s,{parentName:"div",type:"deflist",nr:1,mdxType:"Comment"})),(0,r.kt)("div",{parentName:"admonition",className:"commentable"},(0,r.kt)("p",{parentName:"div"},"Erstellen Sie die folgende Tabelle (beachten Sie die Reihenfolge der L\xe4nder):"),(0,r.kt)(s,{parentName:"div",type:"paragraph",nr:13,mdxType:"Comment"})),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre"},"  Land      |              Namen                   \n------------+--------------------------------------\n Irland     | Larry der St\xfcrmer                    \n \xd6sterreich | Crazy Lego Dude                      \n Schweden   | Litty Feuerwehr                      \n Schweiz    | Botot                                \n USA        | Elon Marsk, A$AP Geerky, Wigwam Tipi \n")),(0,r.kt)(c,{type:"text",webKey:"77d74a75-a953-460d-bf21-09b81af0c8e5",mdxType:"Answer"}),(0,r.kt)(g,{webKey:"cec19b30-2764-41f8-aaf5-58082370ed20",mdxType:"Solution"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'SELECT land as "Land", string_agg(name, \', \') as "Namen"\nFROM legodudes\nGROUP BY land\nORDER BY land\n')))))}b.isMDXComponent=!0}}]);